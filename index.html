<!DOCTYPE html>
<html>
<head>
<style>
    canvas {
    padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
    display: block;
    }
    .slidecontainer {
  width: 100%; /* Width of the outside container */
}
</style>
</head>

<script id="vertex-shader" type="x-shader/x-vertex">
  const int NUM_LIGHTS = 2;
attribute vec3 vPosition;
attribute vec4 vColor;
attribute vec3 normal;

uniform vec4 lineColor;
uniform mat4 modelViewMatrix;

uniform mat4 projectionMatrix;
uniform mat4 translationMatrix;
uniform mat3 normalMatrix;

uniform vec3 lightPositions;
uniform vec3 spotLightAt;

varying vec3 lightRays;
varying vec3 spotLightDirection;
varying vec3 vertPos;


varying vec3 vNormal;
varying vec4 blockColor;
varying vec3 spotlightPosition;



void
main()
{
  //gl_Position = projectionMatrix * modelViewMatrix * translationMatrix * vec4(vPosition, 1.0);

  vec4 vertPos4 = vec4(vPosition, 1.0);
  vertPos = vertPos4.xyz;
  vNormal = normalMatrix * normal;
  vec4 lightPosition = vec4(lightPositions, 1.0);
  lightRays = lightPosition.xyz - vertPos;
  // lightPosition = vec4(lightPositions[1], 1.0);
  //lightRays[1] = lightPosition.xyz - vertPos;
  spotLightDirection = lightPosition.xyz - spotLightAt;
  spotlightPosition = lightPosition.xyz;

    

  gl_Position = projectionMatrix * modelViewMatrix * vertPos4;



}
</script>

<script id="fragment-shader" type="x-shader/x-fragment">
  const int NUM_LIGHTS = 2;
precision mediump float;
varying vec4 blockColor;
varying vec3 vNormal;
varying vec3 vertPos;
uniform vec3 cameraPosition; // Eye position

uniform float Ka[NUM_LIGHTS];   // Ambient reflection coefficient
uniform float Kd[NUM_LIGHTS];   // Diffuse reflection coefficient
uniform float Ks[NUM_LIGHTS];   // Specular reflection coefficient
uniform float shineness[NUM_LIGHTS]; // Shininess



uniform vec3 ambientColor[NUM_LIGHTS];
uniform vec3 diffuseColor[NUM_LIGHTS];
uniform vec3 specularColor[NUM_LIGHTS];

uniform vec3 light; // Light position

varying vec3 spotLightDirection;
uniform float cutOff;

uniform int mode;

varying vec3 lightRays;
varying vec3 spotlightPosition;





void
main()
{
  //Calculate shadowPos

  vec3 N = normalize(vNormal); // normal vector


  vec3 v = normalize(cameraPosition - vertPos);
  // Ambient reflection
    
    vec3 Ia = ambientColor[0] * ambientColor[1] * Ka[0];


    // Lambertian Law
    // Diffuse reflection
    //vec3 L = normalize(light - vertPos);
    vec3 L = vec3(0.0, 0.0, 0.0);
    vec3 Id = vec3(0.0, 0.0, 0.0);
    
    // Specular Reflection
    vec3 halfWayVector = vec3(0.0, 0.0, 0.0);
    float angle = 0.0;

    vec3 Is = vec3(0.0, 0.0, 0.0);
    
        
       //L = normalize(lightRays[0]);
       //halfWayVector = normalize(L+v);
       //Id += diffuseColor[0] * diffuseColor[1] * Kd[0] * max(0.0, dot(N, L));
       //angle = max(0.0, dot(N, halfWayVector));
       //Is += Ks[0] * specularColor[0] * specularColor[1] * pow(angle, shineness[0]);
       
       L = normalize(lightRays);
        float dotFromDirection = dot(L, normalize(spotLightDirection));
        if(dotFromDirection >= cutOff) {
            Id += diffuseColor[0] * diffuseColor[1] * Kd[1] * max(0.0, dot(N, L));
            halfWayVector = normalize(L+v);
            angle = max(0.0, dot(N, halfWayVector));
             Is += Ks[1] * specularColor[1] * specularColor[1] * pow(angle, shineness[0]);
        } 



    vec3 color = Ia + Id + Is; 
    gl_FragColor = vec4(color, 1.0);






    //gl_FragColor = blockColor;
}
</script>

<script type="text/javascript" src="WebGL/webgl-utils.js"></script>
<script type="text/javascript" src="WebGL/initShaders.js"></script>
<script type="text/javascript" src="WebGL/MV.js"></script>
<script type="text/javascript" src="shapes.js"></script>
<script type="text/javascript" src="main.js"></script>

<body>

  <canvas id="gl-canvas" width="1024" height="1024">>
      Oops ... your browser doesn't support the HTML5 canvas element
  </canvas>
          

</body>
</html>
